image:
  repository: tccr.io/truecharts/node-exporter
  pullPolicy: IfNotPresent
  tag: v1.5.0@sha256:674e04af703ffb85daf5cbddc64c5fc92e75ba49a5e2b0c0d14a2a8ccace3590

service:
  main:
    ports:
      main:
        protocol: http
        port: 9100

workload:
  main:
    type: DaemonSet
    replicas: 2
    strategy: RollingUpdate
    podSpec:
      containers:
        main:
          args:
            - --path.procfs=/host/proc
            - --path.sysfs=/host/sys
            - --web.listen-address=0.0.0.0:{{ .Values.service.main.ports.main.port }}
          probes:
            liveness:
              path: /
              port: main

            readiness:
              path: /
              port: main

            startup:
              type: tcp
              port: main

podOptions:
  hostNetwork: true
  hostPID: true

persistence:
  proc:
    enabled: true
    hostPath: /proc
    mountPath: /host/proc
    readOnly: true
  sys:
    enabled: true
    hostPath: /sys
    mountPath: /host/sys
    readOnly: true

metrics:
  main:
    # -- Enable and configure a Prometheus serviceMonitor for the chart under this key.
    # @default -- See values.yaml
    enabled: true
    type: serviceMonitor
    endpoints:
      - port: main
        path: /metrics
    # -- Enable and configure Prometheus Rules for the chart under this key.
    # @default -- See values.yaml
    prometheusRule:
      enabled: false
      labels: {}
      # -- Configure additionial rules for the chart under this key.
      # @default -- See prometheusrules.yaml
      rules:
        []
        # - alert: UnifiPollerAbsent
        #   annotations:
        #     description: Unifi Poller has disappeared from Prometheus service discovery.
        #     summary: Unifi Poller is down.
        #   expr: |
        #     absent(up{job=~".*unifi-poller.*"} == 1)
        #   for: 5m
        #   labels:
        #     severity: critical

portal:
  open:
    enabled: false
